!function(e){"use strict";e.fn.formset=function(t){var a=e.extend({},e.fn.formset.defaults,t),s=e(this),n=s.parent(),i=function(t,a,s){var n=new RegExp("("+a+"-(\\d+|__prefix__))"),i=a+"-"+s;e(t).prop("for")&&e(t).prop("for",e(t).prop("for").replace(n,i)),t.id&&(t.id=t.id.replace(n,i)),t.name&&(t.name=t.name.replace(n,i))},d=e("#id_"+a.prefix+"-TOTAL_FORMS").prop("autocomplete","off"),r=parseInt(d.val(),10),l=e("#id_"+a.prefix+"-MAX_NUM_FORMS").prop("autocomplete","off"),o=""===l.val()||l.val()-d.val()>0;if(s.each(function(t){e(this).not("."+a.emptyCssClass).addClass(a.formCssClass)}),s.length&&o){var f=a.addButton;if(null===f)if("TR"===s.prop("tagName")){var c=this.eq(-1).children().length;n.append('<tr class="'+a.addCssClass+'"><td colspan="'+c+'"><a href="#">'+a.addText+"</a></tr>"),f=n.find("tr:last a")}else s.filter(":last").after('<div class="'+a.addCssClass+'"><a href="#">'+a.addText+"</a></div>"),f=s.filter(":last").next().find("a");f.on("click",function(t){t.preventDefault();var s=e("#"+a.prefix+"-empty"),n=s.clone(!0);n.removeClass(a.emptyCssClass).addClass(a.formCssClass).attr("id",a.prefix+"-"+r),n.is("tr")?n.children(":last").append('<div><a class="'+a.deleteCssClass+'" href="#">'+a.deleteText+"</a></div>"):n.is("ul")||n.is("ol")?n.append('<li><a class="'+a.deleteCssClass+'" href="#">'+a.deleteText+"</a></li>"):n.children(":first").append('<span><a class="'+a.deleteCssClass+'" href="#">'+a.deleteText+"</a></span>"),n.find("*").each(function(){i(this,a.prefix,d.val())}),n.insertBefore(e(s)),e(d).val(parseInt(d.val(),10)+1),r+=1,""!==l.val()&&l.val()-d.val()<=0&&f.parent().hide(),n.find("a."+a.deleteCssClass).on("click",function(t){t.preventDefault(),n.remove(),r-=1,a.removed&&a.removed(n),e(document).trigger("formset:removed",[n,a.prefix]);var s=e("."+a.formCssClass);e("#id_"+a.prefix+"-TOTAL_FORMS").val(s.length),(""===l.val()||l.val()-s.length>0)&&f.parent().show();var d,o,c=function(){i(this,a.prefix,d)};for(d=0,o=s.length;d<o;d++)i(e(s).get(d),a.prefix,d),e(s.get(d)).find("*").each(c)}),a.added&&a.added(n),e(document).trigger("formset:added",[n,a.prefix])})}return this},e.fn.formset.defaults={prefix:"form",addText:"add another",deleteText:"remove",addCssClass:"add-row",deleteCssClass:"delete-row",emptyCssClass:"empty-row",formCssClass:"dynamic-form",added:null,removed:null,addButton:null},e.fn.tabularFormset=function(t,a){var s=e(this),n=function(a){e(t).not(".add-row").removeClass("row1 row2").filter(":even").addClass("row1").end().filter(":odd").addClass("row2")};return s.formset({prefix:a.prefix,addText:a.addText,formCssClass:"dynamic-"+a.prefix,deleteCssClass:"inline-deletelink",deleteText:a.deleteText,emptyCssClass:"empty-form",removed:n,added:function(t){!function(t){t.find(".prepopulated_field").each(function(){var a=e(this).find("input, select, textarea"),s=a.data("dependency_list")||[],n=[];e.each(s,function(e,a){n.push("#"+t.find(".field-"+a).find("input, select, textarea").attr("id"))}),n.length&&a.prepopulate(n,a.attr("maxlength"))})}(t),"undefined"!=typeof DateTimeShortcuts&&(e(".datetimeshortcuts").remove(),DateTimeShortcuts.init()),"undefined"!=typeof SelectFilter&&(e(".selectfilter").each(function(e,t){var a=t.name.split("-");SelectFilter.init(t.id,a[a.length-1],!1)}),e(".selectfilterstacked").each(function(e,t){var a=t.name.split("-");SelectFilter.init(t.id,a[a.length-1],!0)})),n()},addButton:a.addButton}),s},e.fn.stackedFormset=function(t,a){var s=e(this),n=function(a){e(t).find(".inline_label").each(function(t){var a=t+1;e(this).html(e(this).html().replace(/(#\d+)/g,"#"+a))})};return s.formset({prefix:a.prefix,addText:a.addText,formCssClass:"dynamic-"+a.prefix,deleteCssClass:"inline-deletelink",deleteText:a.deleteText,emptyCssClass:"empty-form",removed:n,added:function(t){!function(t){t.find(".prepopulated_field").each(function(){var a=e(this).find("input, select, textarea"),s=a.data("dependency_list")||[],n=[];e.each(s,function(e,a){n.push("#"+t.find(".form-row .field-"+a).find("input, select, textarea").attr("id"))}),n.length&&a.prepopulate(n,a.attr("maxlength"))})}(t),"undefined"!=typeof DateTimeShortcuts&&(e(".datetimeshortcuts").remove(),DateTimeShortcuts.init()),"undefined"!=typeof SelectFilter&&(e(".selectfilter").each(function(e,t){var a=t.name.split("-");SelectFilter.init(t.id,a[a.length-1],!1)}),e(".selectfilterstacked").each(function(e,t){var a=t.name.split("-");SelectFilter.init(t.id,a[a.length-1],!0)})),n()},addButton:a.addButton}),s},e(document).ready(function(){e(".js-inline-admin-formset").each(function(){var t,a=e(this).data(),s=a.inlineFormset;switch(a.inlineType){case"stacked":t=s.name+"-group .inline-related",e(t).stackedFormset(t,s.options);break;case"tabular":t=s.name+"-group .tabular.inline-related tbody:first > tr",e(t).tabularFormset(t,s.options)}})})}(django.jQuery);