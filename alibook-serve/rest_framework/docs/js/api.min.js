function normalizeKeys(e){for(var a=[],t=0;t<e.length;t++)a=a.concat(e[t].split(" > "));return a}function normalizeHTTPHeader(e){return(e.charAt(0).toUpperCase()+e.substring(1)).replace(/-(.)/g,function(e){return e.toUpperCase()}).replace(/(Www)/g,function(e){return"WWW"}).replace(/(Xss)/g,function(e){return"XSS"}).replace(/(Md5)/g,function(e){return"MD5"})}function formEntries(e){var a=new FormData(e);if(void 0!==a.entries)return Array.from(a.entries());for(var t=[],s=0;s<e.elements.length;s++){var n=e.elements[s];if(n.name)if("file"===n.type)for(var i=0;i<n.files.length;i++)t.push([n.name,n.files[i]]);else if("select-multiple"===n.type||"select-one"===n.type)for(i=0;i<n.selectedOptions.length;i++)t.push([n.name,n.selectedOptions[i].value]);else"checkbox"===n.type?n.checked&&t.push([n.name,n.value]):t.push([n.name,n.value])}return t}var responseDisplay="data",coreapi=window.coreapi,schema=window.schema;$(function(){var e=$("#selected-authentication"),a=$("#auth-control"),t=$("#auth_token_modal"),s=$("#auth_basic_modal"),n=$("#auth_session_modal");$("#language-control li").click(function(e){e.preventDefault();var a=$(this).find("a"),t=$(this).closest("ul").find("li").find("a"),s=a.data("language");t.not('[data-language="'+s+'"]').parent().removeClass("active"),t.filter('[data-language="'+s+'"]').parent().addClass("active"),$("#selected-language").text(s);var n=$("pre.highlight");n.not('[data-language="'+s+'"]').addClass("hide"),n.filter('[data-language="'+s+'"]').removeClass("hide")}),$("form.api-interaction").submit(function(e){e.preventDefault();for(var a=$(this).closest("form"),t=a.find(".request-method"),s=a.find(".request-url"),n=a.closest(".modal-content").find(".toggle-view"),i=a.find(".response-status-code"),o=a.find(".meta"),r=a.find(".response-raw-response"),l=a.find(".request-awaiting"),d=a.find(".response-raw"),c=a.find(".response-data"),u=normalizeKeys(a.data("key")),h={},f=formEntries(a.get()[0]),m=0;m<f.length;m++){var p=f[m],v=p[0],w=p[1],C=a.find('[name="'+v+'"]').data("type")||"string";if("integer"===C&&w){var g=parseInt(w);isNaN(g)||(h[v]=g)}else if("number"===C&&w){g=parseFloat(w);isNaN(g)||(h[v]=g)}else if("boolean"===C&&w){void 0!==(g={true:!0,false:!1}[w.toLowerCase()])&&(h[v]=g)}else if("array"===C&&w)try{h[v]=JSON.parse(w)}catch(e){}else if("object"===C&&w)try{h[v]=JSON.parse(w)}catch(e){}else"string"===C&&w&&(h[v]=w)}a.find(":checkbox").each(function(e){var a=$(this).attr("name");h.hasOwnProperty(a)||(h[a]=!1)});var b={requestCallback:function(e){var a=document.createElement("a");a.href=e.url;var n=e.options.method,i=a.pathname+a.hash+a.search;t.text(n),s.text(i)},responseCallback:function(e,a){n.removeClass("hide"),i.removeClass("label-success").removeClass("label-danger"),e.ok?i.addClass("label-success"):i.addClass("label-danger"),i.text(e.status),o.removeClass("hide");var t="HTTP/1.1 "+e.status+" "+e.statusText+"\n";e.headers.forEach(function(e,a){t+=normalizeHTTPHeader(a)+": "+e+"\n"}),a&&(t+="\n"+a),r.text(t)}};window.auth&&"token"===window.auth.type?b.auth=new coreapi.auth.TokenAuthentication({scheme:window.auth.scheme,token:window.auth.token}):window.auth&&"basic"===window.auth.type?b.auth=new coreapi.auth.BasicAuthentication({username:window.auth.username,password:window.auth.password}):window.auth&&"session"===window.auth.type&&(b.auth=new coreapi.auth.SessionAuthentication({csrfCookieName:"csrftoken",csrfHeaderName:"X-CSRFToken"}));new coreapi.Client(b).action(schema,u,h).then(function(e){var a=JSON.stringify(e,null,2);l.addClass("hide"),d.addClass("hide"),c.addClass("hide").text("").jsonView(a),"data"===responseDisplay?c.removeClass("hide"):d.removeClass("hide")}).catch(function(e){var a=JSON.stringify(e.content,null,2);l.addClass("hide"),d.addClass("hide"),c.addClass("hide").text("").jsonView(a),"data"===responseDisplay?c.removeClass("hide"):d.removeClass("hide")})}),$(".toggle-view button").click(function(){var e=$(this).closest(".modal-content"),a=e.find(".response-raw"),t=e.find(".response-data");responseDisplay=$(this).data("display-toggle"),$(this).removeClass("btn-default").addClass("btn-info").siblings().removeClass("btn-info"),"raw"===responseDisplay?(a.removeClass("hide"),t.addClass("hide")):(t.removeClass("hide"),a.addClass("hide"))}),a.find("[data-auth='none']").click(function(t){t.preventDefault(),window.auth=null,e.text("none"),a.find("[data-auth]").closest("li").removeClass("active"),a.find("[data-auth='none']").closest("li").addClass("active")}),$("form.authentication-token-form").submit(function(s){s.preventDefault();var n=$(this).closest("form"),i=n.find("input#scheme").val(),o=n.find("input#token").val();window.auth={type:"token",scheme:i,token:o},e.text("token"),a.find("[data-auth]").closest("li").removeClass("active"),a.find("[data-auth='token']").closest("li").addClass("active"),t.modal("hide")}),$("form.authentication-basic-form").submit(function(t){t.preventDefault();var n=$(this).closest("form"),i=n.find("input#username").val(),o=n.find("input#password").val();window.auth={type:"basic",username:i,password:o},e.text("basic"),a.find("[data-auth]").closest("li").removeClass("active"),a.find("[data-auth='basic']").closest("li").addClass("active"),s.modal("hide")}),$("form.authentication-session-form").submit(function(t){t.preventDefault(),window.auth={type:"session"},e.text("session"),a.find("[data-auth]").closest("li").removeClass("active"),a.find("[data-auth='session']").closest("li").addClass("active"),n.modal("hide")})});